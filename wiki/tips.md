# tips

簡単な Tips 集。信じたことによる不利益の責任は取らない。

* 容赦なく削除する。
  * 要らない機能は削除しよう。
  * 自分で使うためのツールだからできることだ。
  * 幸い Haskell は型があるので、修正すべきところをすぐに教えてくれる。
* 困難は分割する。
  * パッケージがメモリを使いすぎてビルドできないなら、複数のパッケージに分割する。
  * パッケージに GPL であるべきコードが混入していたら、その部分を別のパッケージに切り出す。
  * Haskell では多様な型の機能と言語拡張で、ほとんどのものを切り出せるようになっている。
* ビルド時のフラグはできるだけ使うな。
  * それよりも二つのパッケージに分離することを考えろ。
  * デフォルトの状態でビルドできるのは簡単にチェックできる。なら、そうでない時は？
* stack を使え。
  * 複数の GHC でビルドしたいなら stack を使え。
  * 最近は cabal が高機能になってきているが、それでも stack がユーザーフレンドリーなのには変わりない。
* stack resolver を使え。
  * 依存するパッケージのバージョンに幅を持たせたいときに、とても有効な基準になる。
* hpack を使え。
  * モジュールのファイルを作るだけでパッケージに含まれるようになるのは、細かいことだがストレスがない。
  * モジュールを移動した時もいちいち cabal ファイルを変えに行く必要がなくなる。
  * 以上のことはフォーマッタなどでも実現することができるが、それでも stack を使えば自動的に使えて簡便なのは変わりないし、さらに yaml という一般的な形式を使えるのも良い。
* cryptonite を使え。
  * 暗号学的ハッシュを使いたいときはこれだ。
  * cryptohash は非推奨になった。代替として挙げられているのがこれだ。
  * basement と memory と cryptonite とグループになっているのも良いところだ。
* コードは掃除せよ。
  * 古い base のバージョンに対応するための CPP や、変更によって不要になっている言語拡張の指定を見るのはもうたくさんだ。
* Windows でもビルドせよ。
  * 実際に Windows で使ってみるのが非互換性を見つける一番良い方法である。
* テストは愚直に書け。
  * テストへ自動的に番号を割り振るクールな関数だって？　どんな内容のテストで失敗したのか分からなくしたいのか。おまけに関数の中で `printf` を使っているしな。
* IDE を使え。
  * モジュールや関数の名前を変更するたびに Vim で `:%s/.../.../` と `:wn` を繰り返し打ち続けるのは苦行だ。
* path パッケージを使え。
  * `FilePath` 型ではなく `Path` 型を使え。
  * このパッケージは幽霊型の最も役に立つ例だと断言したいくらい便利だ。幽霊型が出しゃばりすぎていない。本当に必要な性質だけを幽霊型で表している。
* binary のドキュメントは少ない。覚悟しろ。
  * `Binary` 型クラスのインスタンスの書き方は、公式ドキュメントで一回だけ触れられるだけだ。しかしも、それらに使われる `Put` 型と `Get` 型が `Alternative` 型クラスになっていることは言及してくれない。そして、その `empty` が失敗を表すことは内部実装を読むことでしか知れない。
* 予想する原因の中に単純な間違いを常に入れておけ。
  * タイポ、インポート忘れ、型の変え忘れ、名前の変え忘れ、引数の渡し忘れ、……
